<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RunMate</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        :root {
            --primary: #FC4C02;
            --secondary: #00D4AA;
            --bg: #FFFFFF;
            --text: #1A1A1A;
            --text-secondary: #6B6B6B;
            --border: #E5E5E5;
        }
        body { font-family: 'Poppins', sans-serif; background: var(--bg); color: var(--text); overflow: hidden; height: 100vh; }
        .app { display: flex; flex-direction: column; height: 100vh; }
        .header { background: var(--bg); padding: 1rem; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border); }
        .header h1 { font-size: 1.5rem; font-weight: 800; color: var(--primary); }
        .header-actions { display: flex; gap: 0.5rem; }
        .icon-btn { width: 40px; height: 40px; border-radius: 50%; background: #F7F7F7; border: none; font-size: 1.2rem; cursor: pointer; }
        .map-container { flex: 1; position: relative; }
        #map { width: 100%; height: 100%; }
        .stats-overlay { position: absolute; top: 1rem; left: 1rem; right: 1rem; z-index: 1000; background: rgba(255,255,255,0.95); backdrop-filter: blur(20px); border-radius: 20px; padding: 1rem; box-shadow: 0 8px 32px rgba(0,0,0,0.08); }
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; margin-bottom: 1rem; }
        .stat { text-align: center; }
        .stat-label { font-size: 0.7rem; text-transform: uppercase; color: var(--text-secondary); font-weight: 600; margin-bottom: 0.25rem; }
        .stat-value { font-size: 1.8rem; font-weight: 800; color: var(--text); }
        .stat-unit { font-size: 0.9rem; font-weight: 500; color: var(--text-secondary); }
        .controls { display: flex; gap: 0.5rem; }
        .btn-control { flex: 1; padding: 0.875rem; border: none; border-radius: 12px; font-weight: 700; font-size: 0.9rem; cursor: pointer; font-family: 'Poppins', sans-serif; }
        .btn-start { background: var(--secondary); color: white; }
        .btn-pause { background: #FFB800; color: white; }
        .btn-stop { background: #FF3B30; color: white; }
        .friends-panel { position: absolute; bottom: 80px; right: 1rem; z-index: 1000; background: white; border-radius: 20px; padding: 1rem; box-shadow: 0 8px 32px rgba(0,0,0,0.08); display: none; }
        .friends-panel.active { display: block; animation: slideUp 0.3s ease-out; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .friend-item { display: flex; align-items: center; gap: 0.75rem; padding: 0.75rem; margin-bottom: 0.5rem; }
        .friend-avatar { width: 48px; height: 48px; border-radius: 50%; background: linear-gradient(135deg, var(--primary), #FFB800); display: flex; align-items: center; justify-content: center; font-weight: 700; color: white; position: relative; }
        .status-dot { position: absolute; bottom: 0; right: 0; width: 14px; height: 14px; border-radius: 50%; background: var(--secondary); border: 2px solid white; }
        .status-dot.running { background: #FFB800; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
        .friend-info { flex: 1; }
        .friend-name { font-weight: 600; font-size: 0.9rem; }
        .friend-status { font-size: 0.75rem; color: var(--text-secondary); }
        .btn-join { padding: 0.5rem 1rem; border-radius: 20px; background: var(--primary); color: white; border: none; font-weight: 600; font-size: 0.8rem; cursor: pointer; font-family: 'Poppins', sans-serif; }
        .bottom-nav { background: white; border-top: 1px solid var(--border); display: flex; justify-content: space-around; padding: 0.5rem 0; }
        .nav-item { flex: 1; display: flex; flex-direction: column; align-items: center; gap: 0.25rem; padding: 0.5rem; border: none; background: none; cursor: pointer; font-family: 'Poppins', sans-serif; }
        .nav-item.active { color: var(--primary); }
        .nav-icon { font-size: 1.5rem; }
        .nav-label { font-size: 0.7rem; font-weight: 600; }
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 2000; transform: translateY(100%); transition: transform 0.3s ease-out; }
        .modal.active { transform: translateY(0); }
        .modal-header { padding: 1rem; border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 1rem; }
        .btn-back { width: 40px; height: 40px; border-radius: 50%; background: #F7F7F7; border: none; font-size: 1.2rem; cursor: pointer; }
        .modal-title { font-size: 1.25rem; font-weight: 700; }
        .modal-content { overflow-y: auto; height: calc(100vh - 70px); padding: 1rem; }
        .activity-card { background: white; border: 1px solid var(--border); border-radius: 16px; padding: 1rem; margin-bottom: 1rem; }
        .activity-header { display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.75rem; }
        .activity-avatar { width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #FF6B6B, #FFB800); display: flex; align-items: center; justify-content: center; font-weight: 700; color: white; font-size: 0.9rem; }
        .activity-user { flex: 1; }
        .activity-name { font-weight: 600; font-size: 0.9rem; }
        .activity-time { font-size: 0.75rem; color: var(--text-secondary); }
        .activity-text { margin-bottom: 0.75rem; line-height: 1.5; font-size: 0.9rem; }
        .activity-stats { display: flex; gap: 1rem; padding: 0.75rem; background: #F7F7F7; border-radius: 12px; margin-bottom: 0.75rem; }
        .activity-stat { flex: 1; text-align: center; }
        .activity-stat-label { font-size: 0.65rem; color: var(--text-secondary); text-transform: uppercase; font-weight: 600; }
        .activity-stat-value { font-weight: 700; font-size: 1rem; }
        .activity-actions { display: flex; gap: 1rem; padding-top: 0.75rem; border-top: 1px solid var(--border); }
        .action-btn { flex: 1; padding: 0.5rem; background: none; border: none; color: var(--text-secondary); font-weight: 600; cursor: pointer; font-size: 0.85rem; font-family: 'Poppins', sans-serif; }
        .action-btn.liked { color: #FF3B30; }
        .toast { position: fixed; bottom: 100px; left: 50%; transform: translateX(-50%) translateY(100px); background: rgba(26,26,26,0.95); color: white; padding: 1rem 1.5rem; border-radius: 50px; font-weight: 600; font-size: 0.9rem; z-index: 3000; transition: transform 0.3s ease-out; }
        .toast.show { transform: translateX(-50%) translateY(0); }
    </style>
</head>
<body>
    <div class="app">
        <div class="header">
            <h1>üèÉ RunMate</h1>
            <div class="header-actions">
                <button class="icon-btn" onclick="toggleFriends()">üë•</button>
            </div>
        </div>
        <div class="map-container">
            <div id="map"></div>
            <div class="stats-overlay">
                <div class="stats-grid">
                    <div class="stat">
                        <div class="stat-label">Distance</div>
                        <div class="stat-value" id="distance">0.00<span class="stat-unit">mi</span></div>
                    </div>
                    <div class="stat">
                        <div class="stat-label">Time</div>
                        <div class="stat-value" id="time">00:00</div>
                    </div>
                    <div class="stat">
                        <div class="stat-label">Pace</div>
                        <div class="stat-value" id="pace">0:00<span class="stat-unit">/mi</span></div>
                    </div>
                    <div class="stat">
                        <div class="stat-label">Calories</div>
                        <div class="stat-value" id="calories">0<span class="stat-unit">kcal</span></div>
                    </div>
                </div>
                <div class="controls" id="controls">
                    <button class="btn-control btn-start" onclick="startRun()">‚ñ∂Ô∏è Start Run</button>
                </div>
            </div>
            <div class="friends-panel" id="friendsPanel">
                <div class="friend-item">
                    <div class="friend-avatar">SM<div class="status-dot running"></div></div>
                    <div class="friend-info">
                        <div class="friend-name">Sarah Miller</div>
                        <div class="friend-status">Running ‚Ä¢ 3.2 mi</div>
                    </div>
                    <button class="btn-join" onclick="joinRun('Sarah')">Join</button>
                </div>
                <div class="friend-item">
                    <div class="friend-avatar" style="background: linear-gradient(135deg, #6366F1, #8B5CF6);">MJ<div class="status-dot"></div></div>
                    <div class="friend-info">
                        <div class="friend-name">Mike Johnson</div>
                        <div class="friend-status">Online</div>
                    </div>
                    <button class="btn-join" onclick="inviteFriend('Mike')">Invite</button>
                </div>
            </div>
        </div>
        <div class="bottom-nav">
            <button class="nav-item active" onclick="showView('map')">
                <div class="nav-icon">üèÉ</div>
                <div class="nav-label">Run</div>
            </button>
            <button class="nav-item" onclick="showView('feed')">
                <div class="nav-icon">üì±</div>
                <div class="nav-label">Feed</div>
            </button>
            <button class="nav-item" onclick="showView('profile')">
                <div class="nav-icon">üë§</div>
                <div class="nav-label">Profile</div>
            </button>
        </div>
        <div class="modal" id="feedModal">
            <div class="modal-header">
                <button class="btn-back" onclick="closeModal('feed')">‚Üê</button>
                <div class="modal-title">Activity Feed</div>
            </div>
            <div class="modal-content">
                <div class="activity-card">
                    <div class="activity-header">
                        <div class="activity-avatar">SM</div>
                        <div class="activity-user">
                            <div class="activity-name">Sarah Miller</div>
                            <div class="activity-time">2 hours ago</div>
                        </div>
                    </div>
                    <div class="activity-text">Morning run through Central Park! üå§Ô∏è</div>
                    <div class="activity-stats">
                        <div class="activity-stat">
                            <div class="activity-stat-label">Distance</div>
                            <div class="activity-stat-value">5.2 mi</div>
                        </div>
                        <div class="activity-stat">
                            <div class="activity-stat-label">Time</div>
                            <div class="activity-stat-value">42:18</div>
                        </div>
                        <div class="activity-stat">
                            <div class="activity-stat-label">Pace</div>
                            <div class="activity-stat-value">8:08/mi</div>
                        </div>
                    </div>
                    <div class="activity-actions">
                        <button class="action-btn" onclick="toggleLike(this)">‚ù§Ô∏è 24</button>
                        <button class="action-btn" onclick="showNotification('Comments!')">üí¨ 8</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="toast" id="toast"></div>
    </div>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        let map, userMarker, friendMarker, routeLine;
        let isRunning = false, isPaused = false;
        let runDistance = 0, runTime = 0, runInterval, moveInterval;
        let routeCoords = [];

        function initMap() {
            const coords = [40.7580, -73.9855];
            map = L.map('map', { zoomControl: false, attributionControl: false }).setView(coords, 14);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19 }).addTo(map);
            const userIcon = L.divIcon({
                className: 'custom-marker',
                html: '<div style="width: 30px; height: 30px; background: linear-gradient(135deg, #FC4C02, #FFB800); border: 3px solid white; border-radius: 50%; box-shadow: 0 4px 12px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; font-weight: 800; color: white; font-size: 0.65rem;">YOU</div>',
                iconSize: [30, 30],
                iconAnchor: [15, 15]
            });
            userMarker = L.marker(coords, { icon: userIcon }).addTo(map);
            routeLine = L.polyline([], { color: '#FC4C02', weight: 5, opacity: 0.8 }).addTo(map);
            showNotification('Welcome to RunMate! üëã');
        }

        function startRun() {
            if (isRunning) return;
            isRunning = true; isPaused = false; runDistance = 0; runTime = 0; routeCoords = [];
            document.getElementById('controls').innerHTML = '<button class="btn-control btn-pause" onclick="pauseRun()">‚è∏Ô∏è Pause</button><button class="btn-control btn-stop" onclick="stopRun()">‚èπÔ∏è Stop</button>';
            runInterval = setInterval(updateStats, 1000);
            simulateMovement();
            showNotification('Run started! üèÉ‚Äç‚ôÇÔ∏è');
        }

        function pauseRun() {
            if (!isRunning) return;
            isPaused = !isPaused;
            const pauseBtn = document.querySelector('.btn-pause');
            if (isPaused) {
                clearInterval(runInterval); clearInterval(moveInterval);
                pauseBtn.innerHTML = '‚ñ∂Ô∏è Resume';
                showNotification('Paused ‚è∏Ô∏è');
            } else {
                runInterval = setInterval(updateStats, 1000);
                simulateMovement();
                pauseBtn.innerHTML = '‚è∏Ô∏è Pause';
                showNotification('Resumed! ‚ñ∂Ô∏è');
            }
        }

        function stopRun() {
            if (!isRunning) return;
            isRunning = false; isPaused = false;
            clearInterval(runInterval); clearInterval(moveInterval);
            document.getElementById('controls').innerHTML = '<button class="btn-control btn-start" onclick="startRun()">‚ñ∂Ô∏è Start Run</button>';
            alert(`Great run! üéâ\n\nDistance: ${runDistance.toFixed(2)} mi\nTime: ${formatTime(runTime)}`);
            runDistance = 0; runTime = 0; routeCoords = []; routeLine.setLatLngs([]); updateStats();
        }

        function updateStats() {
            if (!isPaused && isRunning) { runTime++; runDistance += (0.12 / 60); }
            document.getElementById('time').textContent = formatTime(runTime);
            document.getElementById('distance').innerHTML = `${runDistance.toFixed(2)}<span class="stat-unit">mi</span>`;
            document.getElementById('pace').innerHTML = `${calculatePace()}<span class="stat-unit">/mi</span>`;
            document.getElementById('calories').innerHTML = `${Math.floor(runDistance * 100)}<span class="stat-unit">kcal</span>`;
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${String(mins).padStart(2, '0')}:${String(secs).padStart(2, '0')}`;
        }

        function calculatePace() {
            if (runDistance === 0) return '0:00';
            const paceMinutes = (runTime / 60) / runDistance;
            const min = Math.floor(paceMinutes);
            const sec = Math.floor((paceMinutes - min) * 60);
            return `${min}:${String(sec).padStart(2, '0')}`;
        }

        function simulateMovement() {
            moveInterval = setInterval(() => {
                if (!isRunning || isPaused) { clearInterval(moveInterval); return; }
                const pos = userMarker.getLatLng();
                const newLat = pos.lat + (Math.random() - 0.5) * 0.0012;
                const newLng = pos.lng + (Math.random() - 0.5) * 0.0012;
                userMarker.setLatLng([newLat, newLng]);
                routeCoords.push([newLat, newLng]);
                routeLine.setLatLngs(routeCoords);
                map.panTo([newLat, newLng], { animate: true });
            }, 2500);
        }

        function toggleFriends() {
            document.getElementById('friendsPanel').classList.toggle('active');
        }

        function joinRun(name) {
            showNotification(`Joining ${name}'s run...`);
            const friendIcon = L.divIcon({
                className: 'custom-marker',
                html: '<div style="width: 30px; height: 30px; background: linear-gradient(135deg, #FF3B30, #FF6B6B); border: 3px solid white; border-radius: 50%; box-shadow: 0 4px 12px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; font-weight: 800; color: white; font-size: 0.65rem;">SM</div>',
                iconSize: [30, 30],
                iconAnchor: [15, 15]
            });
            const userPos = userMarker.getLatLng();
            friendMarker = L.marker([userPos.lat + 0.004, userPos.lng + 0.004], { icon: friendIcon }).addTo(map);
            setTimeout(() => { showNotification(`Connected with ${name}! üéâ`); document.getElementById('friendsPanel').classList.remove('active'); }, 1500);
        }

        function inviteFriend(name) { showNotification(`Invitation sent to ${name}! ‚úâÔ∏è`); }

        function showView(view) {
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            event.target.closest('.nav-item').classList.add('active');
            document.querySelectorAll('.modal').forEach(modal => modal.classList.remove('active'));
            if (view === 'feed') document.getElementById('feedModal').classList.add('active');
        }

        function closeModal(view) {
            document.getElementById(view + 'Modal').classList.remove('active');
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            document.querySelector('.nav-item').classList.add('active');
        }

        function toggleLike(btn) {
            btn.classList.toggle('liked');
            const match = btn.textContent.match(/\d+/);
            const count = match ? parseInt(match[0]) : 0;
            btn.innerHTML = btn.classList.contains('liked') ? `‚ù§Ô∏è ${count + 1}` : `ü§ç ${count - 1}`;
            showNotification('Liked! ‚ù§Ô∏è');
        }

        function showNotification(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => { toast.classList.remove('show'); }, 3000);
        }

        window.addEventListener('load', () => {
            initMap();
            setTimeout(() => { map.invalidateSize(); }, 100);
        });
    </script>
</body>
</html>
